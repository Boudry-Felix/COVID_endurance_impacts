---
params:
  new_title: "My title"
title: "`r params$new_title`"
author: "FÃ©lix Boudry"
date: "`r Sys.Date()`"
documentclass: article
classoption: oneside
lang: en-US
output:
  html_document: 
    toc: yes
    number_section: yes
    fig_caption: yes
    number_sections: yes
  word_document:
    toc: yes
    number_sections: 4
    fig_caption: yes
  pdf_document: 
    toc: yes
    toc_depth: 4
    number_sections: yes
    fig_caption: yes
    df_print: kable
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = FALSE,
	error = TRUE,
	message = FALSE,
	warning = FALSE,
	fig.width = 12
)
# Import libraries
require(tidyverse)
require(knitr)
require(janitor)
require(gridExtra)
```

```{r Configuration}
rm(list = setdiff(
  x = ls(),
  y = c(
    "my_var",
    "gen_env",
    "my_population"
  )
))
```

# Population description

## Anthropometrics

Presentation of the population studied.

In the population kept in this study there are
**`r my_results$num$results_antrop$population_values$sex$feminin`** womens and
**`r my_results$num$results_antrop$population_values$sex$masculin`** mens and all of the
**`r nrow(my_data)`** subjects were infected by COVID-19.

```{r Anthropometrics}
my_table_count(input = my_data$covid_test, my_colnames = c("Tests", "freq"))
my_table(input = my_results$num$results_antrop$antrop_values)
my_results$plots$plots_antrop$antrop_plots %>%
  marrangeGrob(ncol = 3, nrow = 1, top = NULL)
my_table(input = my_results$num$results_antrop$antrop_values)
```

## Training

```{r}
my_results$plots$plots_training$training_plots[c("endurance_sport", "federal_license")] %>%
  marrangeGrob(nrow = 1, ncol = 2, top = NULL)
lapply(
  X = my_results$plots$plots_training$training_plots[c("train_volume", "train_sessions_week", "train_method")],
  FUN = function(x) {
    x + theme(axis.text.x = element_text(angle = 45))
  }
) %>%
  marrangeGrob(nrow = 1, ncol = 2, top = NULL)
my_results$plots$plots_training$training_plots$what_sport +
  theme(axis.text.x = element_text(angle = 45))
my_results$num$results_training$training_values
```

In the studied population, **`r my_results$num$results_training$training_values$endurance_sport$oui`** are endurance
trained athletes.

## Professions

Subject's professions are shown below:

```{r}
my_results$plots$plots_antrop$population_plots$profession
my_table(my_results$num$results_antrop$population_values$profession)
```

## Pathologies

**`r count(my_data$pathology)[2, 2]`** have a known pathology.

```{r}
my_results$plots$plots_pathologies$pathologies_plots$pathology_description +
  theme(axis.text.x = element_text(angle = 45))
my_results$plots$plots_pathologies$pathologies_plots$pathology_medication

my_table(my_results$num$results_pathologies$pathologies_values$pathology_description)
my_table(my_results$num$results_pathologies$pathologies_values$pathology_medication, caption = "Medication")
```

# COVID impact on training

## COVID

### Symptoms

```{r}
my_results$plots$plots_covid$covid_symptoms_plots %>% 
  marrangeGrob(ncol = 2, nrow = 2, top = NULL)
```

## Post COVID

### Symptoms

```{r}
my_results$plots$plots_post_covid$post_covid_infos_plots %>% 
  marrangeGrob(ncol = 2, nrow = 2, top = NULL)
my_results$plots$plots_post_covid$post_covid_symptoms_plots %>% 
  marrangeGrob(ncol = 2, nrow = 2, top = NULL)
my_results$plots$plots_post_covid$training_symptoms_plots %>% 
  marrangeGrob(ncol = 2, nrow = 2, top = NULL)
my_results$plots$plots_post_covid$training_symptoms_notes_plots %>% 
  marrangeGrob(ncol = 2, nrow = 2, top = NULL)
my_results$plots$plots_post_covid$post_covid_difficulties_plots %>% 
  marrangeGrob(ncol = 2, nrow = 2, top = NULL)
```

### Training difficulties

### Hypoxia training

```{r}
my_results$plots$plots_hypoxia$hypoxia_plots %>% 
  marrangeGrob(ncol = 2, nrow = 2, top = NULL)
```

